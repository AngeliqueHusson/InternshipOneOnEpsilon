I want to talk about NSA surveillancethat 's been in the news latelybut most people do n't know how they doit how they actually do it how can theyread our emails how can they sort ofeavesdrop well it turns out it 's basedon very sophisticated math and somesuper long and super big numbers and I'mgoing to show you some of those numbersthat sound good yeah we love numberswell I have to set it up a little bit Iwant to talk a little bit aboutsomething you know which we use it inour everyday life the clock so let 's sayyou start you start working at 9:00 inthe morningokay and you work for five hours when doyou finish you finish apps - okay but ifyou you know if you were to calculatenine plus five you get 14 why do we say2:00 p.m. and not 14that 's because 14 is 12 plus 2 so whenwe get a result like 14 which is largerthan 12 then we sort of just take theremainder this is called clockarithmetic and also in mathematics wecall it modular arithmetic because wesay that 9 plus 5 is 2 modulo 12 modulojust means that we retain the remainderso likewise we can imagine a clock whichdoes n't have 12 hours but has any otherwhole number is the number of hours forexample could be 10 hours could be 5hours could be you know 5368hours but actually in mathematics thebest clocks are the ones in which thenumber of hours is a prime number itturns out that actually there are somereally sophisticated things about thisarithmetic but of course thesophistication you can can only feelwhen that number of hours becomes largerif it 's all modulo 7 modulo 12 thereis n't so much room to create somethingcomplicated that we could use anencryption say but if that number iszillions of zillions of zillions youknow then that that opens theopportunity to do something that otherpeople can not crack examples and when wesend our credit card number online or wesend an email it gets scrambled and thengets unscrambled at the endpoint that isbased on this kind of arithmeticarithmetic with some very large nonprime number of hours and I 'll show youwhat the actual numbers involved in abit but let me explain a little bit moreabout what this algorithms are based onso first well they are based on thisclock arithmetic as we already wealready understand that and there is onemore layer which is that we also look atequations at an equation with twovariables the kind of equations that gointo the algorithms that NSA was able tocrack have to do with whatmathematicians call elliptic curves soan elliptic curve is something which isifsigned by an equation like this ysquared equals x cubed minus 3x plus 5so that 's an equation in two variables xand y to solve this equation means tofind two numbers x and y such that theleft-hand side is equal to the righthand side but there is a crucial elementwhere exactly do we look for solutionsthere are many options of course theobvious choice would be to look forsolutions say in real numbers and thenthis will actually give us a curve whichwill look something like thisyou know every point here will have twocoordinates x and y and if you plug theminto this equation left hand side orequal to the right hand side so that'sthe most obvious way to think ofsolutions being armed with this newarithmetic at the clock arithmetic wecan also look for solutions modulo someprime number right nothing can stop usfrom doing that so for example we canchoose x and y to be elements of thisset of possible hours on this seven hourclock and we can try to look for pairs xand y such that the left-hand side isequal to the right hand side so this waywe get something like think of this assort of like a sub so maybe some pointson this kind of curve so there are lesssolutions there are fewer solutions forsure because well to begin with x and ycan only take values from 1 to 7 we cansort of think of them as some specialpoints on this curve and of course ifyou take a very large prime number thenthere will be more many more solutionsthat if you take a small one like 7 andthere is a whole industry in mathematicswhich is called elliptic curvecryptography and elliptic curvecryptography has to do with using thissolutions to scramble and unscramblemessages when when they are undertransmitted there are some standards inthis area which were set by by NationalInstitute standard technology which is abody in the United States which isresponsible for these kind of things itcame up with the standards and in factyou can you can read this is all publicknowledge this was not classified hereis the algorithm just call this dualdual elliptic curve deterministic randombits generator so you see the ellipticcurve is prominently featured here andthis is equation it 's exactly theequation that I wrote well you simplifyit 's a very simple equation but you haveto pick a prime number in this documentthey actuallygive you details they provide you thisnumber P so see this is the first largenumber gives you the largest clock ifyou 've ever seen look how many digitsthere are so that 's the that 's the clockthey 're using in on their code that'sright so on their curve on this on theirequation they 're using this many hoursokay so so in the their day has manymore hours than we 're used to in somesense right and then then there are someadditional is some additional data thathave to be used in this algorithm and soyou use those data and as a result youcreate something which produces numbersthat look totally random those numbersthemselves do not live on the curve butthe curve is used to produce them it'sactually very important problem inmathematics to produce numbers that lookcompletely random so this by itself isnot an encryption algorithm it 's notused to encrypt a specific email or aspecific credit card number but ratherit produces something based on whichother algorithms which would actually beencrypting your emails or your creditcard numbers be working it 'll be basedon thatthat 's a flowchart which generatesrandom numbers you start with somethingand there 's sort of like a loop whichcreates more and more and more numbersand then they get scrambled and then theoutput is some number from which youjust extract bits and the way it 's setup it should be so that they arecompletely random that in other words ifsomebody reads those numbers they cannotpredict what 's the next numbers comingout so in addition to this equationitself in addition to the prime numberwhich is given what makes this work is apair of solutions you need the stick tokickstart that 's right to kickstart andthen to keep going is used to run thecycle to produce the next one and nextone the next one and Q is used to kindof scramble the output of that cycle sothat in theory nobody would be able topredict what 's what 's you know the nextone think of this solutions as beingsome points on a curve and this by theway it 's very difficult to find thosesolutions because in the numbersinvolved a huge so it 's not an easy taskat all but this government agency issort of simplifying our life and they'resaying look you do n't have to look forsolutions yourself we 'll give you thesolutions we 'll give you this two pointsokay so here 's P maybe he 's here and Qis here let 's just give you this sothese are the numbers actually there youcan see them here oh this is a big moneythis sorry this is our big money shot pxpy QX qy these are the numbers which thegovernment says these are the solutionsand actually anybody can this is publicinformation is public knowledge anybodycan take this numbers and substitute inthe equation and see that indeed theequations satisfied but they found thisfor you okay so now youthey suggest to use these two numbers torun the to run this number random numbergenerator if all of these companies usedthe same equation and the same numbersprovided by the government and thenstart of their flowchart machine weren'tthey all generating the exact samenumbers we 're good one there is a seedalso you have to start with somethingand that you can choose yourself and ofcourse that 's what will distinguish yoursequence from other people sequence butthey give you P and Q which are kind oflike the the two steps and which providethe information to run the steps of theprocedure right it 's a multi it 's amulti-step procedure it 's a flowchartreally and to implementsteps you need those two points and thewhat is implicit here is a suggestionthat this to a kind of random P and Qare kind of random that they are notthey do n't bear any relation with eachother so it 's almost like they give youtwo random villages in Australia andthey say and you 're like you 've neverbeen to Australia so you you do n't knowyou know where they are what thedistance between it between them is andyou expect that no one else would knowit may not be such a good analogybecause of course in case of villages inAustralia you can easily find out whatthe distance is but imagine somethingwhere actually it would be incrediblyhard to find the relation between stillnumbers but imagine that somebodyactually knows what the relation is andas now we find out actually NSAapparently did know a relation and thenthe point is that in that case there isa backdoor that you can use thatinformation sort of the distance betweenthe two villages in Australia you canuse it to be able to predict the outcomeof the algorithm once you know you canobserve it for some period of time andsee what numbers are coming out then youcan actually find out what the next onesare going to be and that sort of throwsa whole sort of a monkey wrench in thewhole procedure because then it givesyou a way to peek until this otherencryption algorithms which rely on thisrandom number generator and that 's whathappened what has the NSA got what didthey do that means they were able tofind the relation but spies from othercountries or mathematicians though youca n't do it or did they reverse-engineerit did they make the equation there thereverse-engineered yes that 's the pointand the the thing is it 's very hard tofind that relation if you do n't alreadyknow it and this is actually the basisof this whole this whole idea ofencryption based on a clock arithmeticthat there are certain problems whichyou when you do in clock arithmeticwhich are intractable it would takeyears on even on a network ofsupercomputers to be able to find asolution so in the video description isgoing to be a bunch of links should havea look at that 's going to includedocuments that we discussed in thisvideo they 're all public documents acontinuation of the discussion I hadwith the professor that did n't make itinto this video and that covers a wholerange of interesting topics like thepeople who actuallyforesaw that maybe this was a problemwhy companies were spoon-fed thisinformation and also the importance ofmathematics in the world these days it'sworth a look and I 'll also include alink to Professor Frank Hills book thisis it here it 's called love and mathit 's really good it 's worth a look ifyou 're into mathematics books and youshould be because you 're watchingnumberphile and lastly thank you toeveryone for your support through 2013and watching numberphile it 's been greatfun making videos like this andhopefully there 's going to be a lot morein 2014Cheers How did the NSA hack our emails? How did the NSA hack our emails? How did the NSA hack our emails?